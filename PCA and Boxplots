install.packages("tidyverse")
install.packages("ggpubr")

library(tidyverse)
library(ggpubr)
theme_set(theme_pubr())

#This scrip brings commands for drawing PCA plots and violin plots in RStudio. You can use these commands when working with descriptive stats for morphometrics.

install.packages("ggplot2")
install.packages("ggfortify")
library ("ggplot2")
library ('ggfortify')

#Count data

Plagiogyria_morpho %>% count(Group2, wt = NULL, sort = FALSE, name = NULL)

Plagiogyria_morpho_nm %>% count(Group2, wt = NULL, sort = FALSE, name = NULL)

# PCA plot - data selection
myPr <- prcomp (Plagiogyria_morpho[, 4:10], scale = TRUE)
myPrFert <- prcomp (Plagiogyria_morpho_nm[, 4:13], scale = TRUE)

df <- Plagiogyria_morpho[4:10]
pca_res <- prcomp(df, scale. = TRUE)

dfFert <- Plagiogyria_morpho_nm[4:13]
pca_resFert <- prcomp(dfFert, scale. = TRUE)

autoplot(pca_res)
autoplot(pca_resFert)

autoplot(pca_res, data = Plagiogyria_morpho, colour = 'Group2', loadings=TRUE, loadings.colour='black', loadings.label=TRUE, loadings.label.size=2, loadings.label.colour='black', frame = TRUE, frame.type = 'norm')
autoplot(pca_res, data = Plagiogyria_morpho, colour = 'Group2', loadings=TRUE, loadings.colour='black', loadings.label=TRUE, loadings.label.size=2, loadings.label.colour='black', frame = FALSE, frame.type = 'norm')

autoplot(pca_resFert, data = Plagiogyria_morpho_nm, colour = 'Group2', loadings=TRUE, loadings.colour='black', loadings.label=TRUE, loadings.label.size=2, loadings.label.colour='black', frame = TRUE, frame.type = 'norm')
autoplot(pca_resFert, data = Plagiogyria_morpho_nm, colour = 'Group2', loadings=TRUE, loadings.colour='black', loadings.label=TRUE, loadings.label.size=2, loadings.label.colour='black', frame = FALSE, frame.type = 'norm')


#PCA summary
myPr$x
myPrFert$x

#Draw boxplots (Sterile dataset)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$SterPetLength)) + geom_boxplot() + 
  labs(x="Group", y="Sterile Petiole Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$SterBladeLength)) + geom_boxplot() + 
  labs(x="Group", y="Sterile Blade Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$SterBladeWidth)) + geom_boxplot() + 
  labs(x="Group", y="Sterile Blade Width (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$PinnaeNumber)) + geom_boxplot() + 
  labs(x="Group", y="Pinna number")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$PinnaeLength)) + geom_boxplot() + 
  labs(x="Group", y="Pinna Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$PinnaeWidth)) + geom_boxplot() + 
  labs(x="Group", y="Pinna Width (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho, aes(x=Plagiogyria_morpho$Group2, y = Plagiogyria_morpho$ProxAngle)) + geom_boxplot() + 
  labs(x="Group", y="Angle (degrees)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

#Draw boxplots (Fertile dataset)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$SterPetLength)) + geom_boxplot() + 
  labs(x="Group", y="Sterile Petiole Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$SterBladeLength)) + geom_boxplot() + 
  labs(x="Group", y="Sterile Blade Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$SterBladeWidth)) + geom_boxplot() + 
  labs(x="Group", y="Sterile Blade Width (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$PinnaeNumber)) + geom_boxplot() + 
  labs(x="Group", y="Pinna Number")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$PinnaeLength)) + geom_boxplot() + 
  labs(x="Group", y="Pinna Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$PinnaeWidth)) + geom_boxplot() + 
  labs(x="Group", y="Pinna Width (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$ProxAngle)) + geom_boxplot() + 
  labs(x="Group", y="Angle (degrees)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$FertPetLength)) + geom_boxplot() + 
  labs(x="Group", y="Fertile Petiole Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$FertBladeWidth)) + geom_boxplot() + 
  labs(x="Group", y="Fertile Blade Width (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)

ggplot(data = Plagiogyria_morpho_nm, aes(x=Plagiogyria_morpho_nm$Group2, y = Plagiogyria_morpho_nm$FertBladeLength)) + geom_boxplot() + 
  labs(x="Group", y="Fertile Blade Length (cm)")+ geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(1), dotsize = 0.5)
